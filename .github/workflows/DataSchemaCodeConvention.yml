name: Data Schema Code Convention Check

on:
  push:
  workflow_dispatch:

jobs:
  check_schema:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v3

      - name: Install SQLFluff
        run: |
          pip install sqlfluff

      - name: Lint SQL schema
        run: |
          echo "Running SQLFluff..."

          if [ -f DataSchema.sql ]; then
            FILE="DataSchema.sql"
          else
            echo "DataSchema.sql not found â†’ FAIL"
            exit 1
          fi

          sqlfluff lint "$FILE" --dialect postgres
